\chapter{Podatkovne zbirke Svetovne Banke}

Pri diplomski nalogi smo se osredoto"cili na dva programska vmesnika za dostop 
podatkov Svetovne banke, to sta ``ClimateAPI'' s katerim dostopamo do 
podatkovne zbirke meteorolo"skih meritev in ``IndicatorAPI'' s katerim dostopamo do 
zbirke podatkov raznih indikatorjev stopenj razvoja dr"zav.
Za uporabo podatkovne zbirke Svetovne banke smo se odlo"cili, ker zdru"zuje in na
enovit na"cin predstavi podatke iz ve"cih razli"cnih virov. Podatkovni viri za 
indikatorje stopnje razvoja dr"zav so:
\begin{itemize}  
  \item Svetovni indikatorji razvoja~\cite{world_dev_ind} % World Development Indicators, 
  \item Globalni finan"cni razvoj~\cite{glob_fin_dev}
  \item Afri"ski indikatorji razvoja~\cite{africa_dev_ind}
  \item Poslovanje~\cite{doing_buseness},
  \item Podjetni"ske raziskave~\cite{ent_surveys}, 
  \item Razvojni cilji~\cite{mil_dev_goals}, 
  \item Statistike izobra"zevanja~\cite{edu_stat}, 
  \item Statistike spolov~\cite{gen_stat},
  \item Statistike zdravja in prehranjevanja~\cite{health_pop_stat},
  \item Rezultati meritev IDA~\cite{ida_res_mes_sys}.
\end{itemize}  

Podatkovni vir zbirke podnebnih meritev pa je osnovan na podatkih oddelka
za podnebne raziskave (ang.\ Climatic Research Unit)~\cite{climate_data}.

Svetovna banka omogo"ca dostop do podatkov preko programskega vmesnika REST, ki
ponuja veliko mo"znosti za iskanje in presejanje rezultatov. Pri vsaki 
poizvedbi REST lahko dolo"cimo "zeljeno obliko odgovora. Za poizvedbe o 
informacijah indikatorjev sta na voljo obliki XML in JSON. Programski vmesnik 
meteorolo"skih meritev pa ponuja samo obliko JSON. Za konsistentnost in la"zjo
berljivost smo na obeh programskih vmesnikih uporabili obliko JSON. To na
programskem vmesniku indikatorjev dosezemo take da nastavimo parameter GET
\verb|format| na vrednost \verb|json|. 


\section{Podatki indikatorjev razvoja dr"zav}



Programski vmesnik indikatorjev razvoja dr"zav Svetovne banke omogo"ca dostop
do podatkov preko 16.000 raznih indikatorjev. Podatki indikatorjev so merjeni
mese"cnem, "cetrtletnem ali letnem intervalu. Zacete meritev podatkov
posameznega indikatorja je odvisna od vira podatkov. Najstaresi podatki segajo
do leta 1960. Poleg podatkov indikatorjev nam ta programski vmesnik omogo"ca tudi dostop do ve"cine
metapodatkov s katerimi lahko presejamo in natan"cneje dolo"cimo na"so poizvedbo.
Seznami metapodatkov so:
\begin{itemize}
\item viri podatkov in njihovi opisi (ang.\ Catalog Source Queries
	\fnurl{http://api.worldbank.org/sources}),
\item seznam dr"zav, skupin dr"zav in regij z identifikatorji (ang.\ Country Queries
	\fnurl{http://api.worldbank.org/countries}),
\item razdelitev vi"sin dohodkov z identifikatorji (ang.\ Income Level Queries
	\fnurl{http://api.worldbank.org/incomeLevels}),
\item seznam vseh indikatorjev (ang.\ Indicator Queries
  \fnurl{http://api.worldbank.org/indicators}),
\item seznam tipov posojil (ang.\ Lending Type Queries
	\fnurl{http://api.worldbank.org/lendingTypes}),
\item seznam tem (ang.\ Topics \fnurl{http://api.worldbank.org/topics}).
\end{itemize}


Vsi odgovori na veljavne poizvedbe po podatkih in metapodatkih, ki so na voljo
s programskim vmesnikom indikatorjev razvoja, imajo enako osnovno obliko. 
Poizvedbe vra"cajo seznam z dvema elementoma, kjer je ima prvi element 
informacije o koli"cini podatkov in trenutnem izboru podatkov, drugi element 
pa vsebuje seznam izbranih podatkov (Primer \ref{basic_response}). 
Veljavne poizvedbe, ki ne vra"cajo podatkov, imajo vrednost drugega elementa
osnovnega seznama \verb|null|.
Za neveljavne poizvedbe, pa programski vmesnik vraca seznam z enim elementom,
ki vsebuje podatke o napaki poizvedbe (Primer \ref{error_response}).


\begin{snippet}
\begin{center}
\begin{lstlisting}
[
    {
        "page": 4,
        "pages": 137,
        "per_page": "50",
        "total": 6831
    },
    [
        {<podatki>},
        ...
    ]
]
\end{lstlisting}
\end{center}
\caption{Osnovna oblika odgovora programskega vmesnika Svetovne banke, za
veljavne poizvedbe.}
\label{basic_response}
\end{snippet} 


\begin{snippet}
\begin{center}
\begin{lstlisting}
[
    {
        "message": [
            {
                "id": "120",
                "key": "Parameter 'country' has an invalid value",
                "value": "The provided parameter value is not valid"
            }
        ]
    }
]
\end{lstlisting}
\end{center}
\caption{Osnovna oblika odgovora programskega vmesnika Svetovne banke, za
neveljavne poizvedbe.}
\label{error_response}
\end{snippet} 


\subsection{Opis seznama indikatorjev}

% TODO: koda ali sifra ali identifikator / zamenji vse povsod.
Do seznama vseh indikatorjev razvoja lahko dostopamo na naslovu 
\verb|http://api.worldbank.org/indicators|
Programski vmesnik Svetovne banke za indikatorje razvoja nam ponuja seznam 
vseh indikatorjev z imeni, opisi, kodami in drugimi metapodatki 
(Primer \ref{indicator_response}). Programski vmesnik nam tudi omogo"ca
presejanje podatkov glede na vir podatkov indikatorja (ang. source).

\begin{snippet}
\begin{center}
\begin{lstlisting}
{
    "id": "1.0.HCount.2.5usd",
    "name": "Poverty Headcount (\$2.50 a day)",
    "source": {
        "id": "37",
        "value": "LAC Equity Lab"
    },
    "sourceNote": "The poverty headcount index measures 
                   the proportion of the population
                   with daily per capita income (in 
                   2005 PPP) below the poverty line.",
    "sourceOrganization": "LAC Equity Lab tabulations
                           of SEDLAC (CEDLAS and the
                           World Bank).",
    "topics": [
        {
            "id": "11",
            "value": "Poverty "
        }
    ]
}
\end{lstlisting}
\end{center}
\caption{Podatki indikatorja 
% TODO
% Ali moram ime indikatorja oznaciti (naprimer velika zacetnica)
% > Podatki indikatorja Stopnja rev...
stopnja rev"s"cine pri dohodku 2,5 dolarja na dan.}
\label{indicator_response}
\end{snippet} 

\subsection{Opis seznama dr"zav}

Seznam dr"zav\textsuperscript{\ref{country_list}}  na programskem vmesniku 
Svetovne banke vsebuje podatke o imenih, opisih, ISO-3166-1 alpha kodah, 
regijah in druge metapodatke (Primer \ref{country_response}). Programski
vmesnik nam tudi omogo"ca presejanje seznama dr"zav po naslednjih poljih:
\begin{description}
\item [id] koda,
\item [region] regija,
\item [incomeLevel] vi"sina dohodka,
\item [lendingType] tipov posojil. % TODO preveri prevod!
\end{description}

Ta seznam ne vsebuje zgolj samo dr"zav, ampak tudi regije in skupine dr"zav, 
zdru"zenih glede na razli"cne kriterije (vi"sine dohodka, velikost, stopnja
razvoja). Poleg tega zgornji seznam vsebuje tudi nekatere izjeme kot je trenutno
Kosovo. V nadaljevanju bomo za vse na"stete tipe lokacijskih podatkov
uporabljali besedo ``dr"zave''.

\begin{snippet}
\begin{center}
\begin{lstlisting}
{
    "id": "ABW",
    "iso2Code": "AW",
    "name": "Aruba",
    "region": {
        "id": "LCN",
        "value": "Latin America & Caribbean "
    },
    "adminregion": {
        "id": "",
        "value": ""
    },
    "incomeLevel": {
        "id": "HIC",
        "value": "High income"
    },
    "lendingType": {
        "id": "LNX",
        "value": "Not classified"
    },
    "capitalCity": "Oranjestad",
    "longitude": "-70.0167",
    "latitude": "12.5167"
},
\end{lstlisting}
\end{center}
\caption[some]{Izsek podatkov veljavne poizvedbe dr"zav.}
\label{country_response}
\end{snippet} 


\subsection{Dostop do podatkov indikatorjev}


Za dostop do podatkov posameznega indikatorja, potrebujemo kodo
indikatorja s seznama vseh indikatorjev in kodo ene ali ve"c dr"zav. 

\begin{snippet}
\begin{center}
\begin{lstlisting}
 http://api.worldbank.org/en/countries/<country>/indicators/<indicator_id>?<parametri>
\end{lstlisting}
\end{center}
\caption{}
\label{indicator_datase_request}
\end{snippet} 


Privzeta vrednost za
koli"cino podatkov na stran je 50, zgornja meja pa ni strogo dolo"cena, vendar
je odvisna od velikosti odgovora. Ugotovili smo tudi, da se zanesljivost
programskega vmesnika manj"sa z ve"cjo koli"cino podatkov na stran. V na"sem 
programu smo se omejili na 1000 podatkov na stran, kar se je izkazalo za 
uporabno razmerje med hitrostjo in zanesljivostjo prenosa. 


Za pridobivanje podatkov indikatorjev se uporablja dostopna tocka \\
% TODO: kako z dolgimi linki in to spravit v kodo
http://api.worldbank.org/countries/<country\_list>/indicators/<indicator\_id>, \\
kjer je:


\begin{description}
\item [country\_list] s podpi"cjem lo"cen seznam kod izbranih dr"zav, ki jih 
	  preberemo iz polja ``id'' ali ``iso2Code'' \ref{country_response}, ali pa 
      klju"cna beseda ``all'',
\item [indicator\_id] polje ``id'' indikatorja \ref{idicators_response} s seznama
      indikatorjev.
\end{description}

API omogo"ca "ze z eno samo poizvedbo dostop do podatkov ene dr"zave, ve"c izbranih 
dr"zav hkrati ali pa do podatkov vseh dr"zav dostopamo s klju"cno besedo ``all''.
Slabost API-ja SB je v tem, da ne moremo z eno poizvedbo dostopati do podatkov
ve"c indikatorjev hkrati. Podatke lahko presejamo po naslednjih poljih:
\begin{description}  
\item [MRV] "stevilo zadnjih meritev,
\item [frequency] pogostost vzor"cenja (letno, "cetrtletno, mese"cno),
\item [gapfill] manjkajo"ce vrednosti prej"snjih meritev,
\item [date] datum ali obdobje,
\item [page] stran,
\item [per\_page] "stevilo elementov na stran.
\end{description}

Privzeto bo programski vmesnik vrnil podatke za vse mo"zne "casovne 
vrednosti. V odgovoru API-ja dobimo seznam objektov (Primer
\ref{dataset_response}) z datumom, indikatorjem, dr"zavo in vrednostjo.


\begin{snippet}
\begin{center}
\begin{lstlisting}
{
    "indicator": {
        "id": "SP.POP.TOTL",
        "value": "Population, total"
    },
    "country": {
        "id": "IL",
        "value": "Israel"
    },
    "value": "6289000",
    "decimal": "0",
    "date": "2000"
}
\end{lstlisting}
\end{center}
\caption{Podatki za indikator SP.POP.TOTL (populacija dr"zave) za Izrael leta
2000.}
\label{dataset_response}
\end{snippet} 


\section{Podatki podnebnih meritev}

Programski vmesnik Svetovne banke za podnebne podatke omogo"ca dostop do 
podatkov napovednih modelov in zgodovinskih meritev meteorolo"skih postaj. V tej 
diplomski nalogi smo se odlo"cili uporabiti samo podatke zgodovinskih meritev, 
saj si s temi podatki lahko uporabnik programa Orange sam sestavi svoje 
napovedne modele.

Za razliko od uporabe programskega vmesnika indikatorjev, lahko pri tem
programskem vmesniku uporabljamo veljavne ISO 3166-1 alpha-2 ali ISO 3166-1 
alpha-3 kode dr"zav, ali pa "stevilski identifikator (TODO link) vodoto"cnega 
obmo"cja.

Ta programski vmesnik nam omogo"ca dostop do podatkov o povpre"cnih temperaturah 
in padavinah v "casovnih obdobjih enega leta, desetletja ali pa nam omogo"ca 
dostop do mese"cnih povpre"cij skozi vsa leta meritev.


\subsection{Dostop do podatkov podnebnih meritev}

Dostop do podatkov podnebnih meritev je mogo"c na naslovu \\
% TODO
http://climatedataapi.worldbank.org/climateweb/rest/\\
v1/\textbf{loc\_type}/cru/\textbf{data\_type}/\textbf{interval}/\textbf{location}\\
kjer je:
\begin{description}
\item [loc\_type] vrsta identifikatorja obmo"cja (``basin'' za vodotocno obmo"cje, 
  ``country'' za dr"zave),
\item [data\_type] vrsta meritev (``pr'' za padavine, ``tas'' za temperature),
\item [interval] vrsta meritvenega obdobja (``month'' za mese"cno, ``year'' za letno in
  ``decade'' za desetletno),
\item [location] identifikator dr"zave ali vodoto"cnega obmo"cja.
\end{description}


Izsek podatkov (primer za mese"cno povpre"cje koli"cine padavin za Slovenijo):
http://climatedataapi.worldbank.org/climateweb/rest/v1/country/cru/pr/month/SVN

\begin{lstlisting}
{
    "month": 0,
    "data": 68.93643
},
{
    "month": 1,
    "data": 64.23069
},
{
    "month": 2,
    "data": 81.098724
},
...
\end{lstlisting}











\section{Te"zave pri dostopu}


Tezave pri uporabi SB API-ja lahko razdelimo v dve skupini. Prvo skupino
sestavljajo te"zave pri dokumentaciji in z manjkajo"cimi podatki, drugo pa
napake v samih pridobljenih podatkih.

Te"zave prve skupine:

\begin{itemize}  
\item ob posodabljanju spletne strani SB se izgubijo posamezne povezave do 
  primerov, dokumentacije in opisov API-ja,
\item nepopolna dokumentacija:
\subitem polje za datum je opisano, vendar ni dokumentirano, kak"sne so vse mo"zne 
    vrednosti,
\subitem delovanje polj za obdobje (date), zadnje vrednosti (mrv) in za mankjajo"ce
    vrednosti (gapfill) ni ustrezno opisano.
\end{itemize}  

Te"zave druge skupine:


\begin{itemize}  
\item manjkajo"ci identifikatoriji za polja na posameznih indikatorjih (primer je
  manjkajo"ca vrednost v polju id dr"zave),
\item datum vsebuje naklju"cne vrednosti (``last known value'' ``2001 - 2015'' ``2040''
\item zgornja meja "stevila izbranih lokacij na 250 ni navedena,
\item nemogo"ce je ugotoviti pogostost vzor"cenja indikatorja (frequency).
\end{itemize}  







